!function(t,n){for(var e in n)t[e]=n[e];n.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}(window,function(){"use strict";var t={408:function(t,n,e){var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}u((i=i.apply(t,n||[])).next())}))},r=this&&this.__generator||function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.unbluIntegrationComponent=void 0;var o=e(274),a=e(350),s="@@unblu.api.key@@",u="/ap/ga/ub",c="@@unblu.server.url@@",l="@@unblu.integration.component.basename@@",p=["/sc/unblu.interceptor.min.js"],f="/sc/unblu.video.ext.js",h="unblu.video.ext.js",d=!1,v=[],y=function(t){(window.unbluIntegrationComponentLogLevel||-1!==document.location.href.indexOf("debugUIC"))&&console.log("UIC: "+t)};function I(){return i(this,void 0,void 0,(function(){var t,n,e=this;return r(this,(function(a){switch(a.label){case 0:return y("isSessionActive called"),t=function(){return i(e,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return m(),[4,o.api.initialize()];case 1:return[4,t.sent().getActiveConversation()];case 2:return[2,null!==t.sent()]}}))}))},[4,function(){return i(e,void 0,void 0,(function(){return r(this,(function(n){return[2,new Promise((function(n,e){if("complete"===document.readyState){if("INITIAL"===o.api.getApiState())return void n(!1);n(t())}else window.addEventListener("load",(function(e){"INITIAL"!==o.api.getApiState()?n(t()):n(!1)}))}))]}))}))}()];case 1:return n=a.sent(),y("isSessionActive result: "+n),[2,n]}}))}))}function A(t){return i(this,void 0,void 0,(function(){return r(this,(function(n){return y("loadScript called for "+t),[2,new Promise((function(n,e){var i=document.createElement("script");i.setAttribute("src",t),i.setAttribute("defer","defer"),i.onload=function(t){return n()},i.onerror=function(t){return e(t.message)},document.head.appendChild(i)}))]}))}))}function b(){return i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return y("loadCustomScripts called"),t=[],p.forEach((function(n){n.startsWith("@")||t.push(A(n))})),[4,Promise.all(t)];case 1:return n.sent(),[2]}}))}))}function E(){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return y("customMobileHandling called"),window.matchMedia("screen and (max-width:544px)").matches?[4,I()]:[3,4];case 1:return t.sent()?(y("customMobileHandling detected active conversation and mobile device: collapsing UI"),m(),[4,o.api.initialize()]):[3,4];case 2:return[4,t.sent().ui.collapseIndividualUi()];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))}function g(){var t=this;o.api.isInitialized()||(y("Setting up lazy api init event listener"),o.api.on("ready",(function(){return i(t,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return v.length>0?(m(),[4,o.api.initialize()]):[3,2];case 1:t=n.sent(),v.forEach((function(n){return t.setNewConversationInterceptor(n)})),v=[],n.label=2;case 2:return[2]}}))}))})))}function w(){var t="unblu.integration.component";return l.startsWith("@")||y("Using integrationScriptBaseName: "+(t=l)),t}function N(){var t=null,n=document.querySelector("script[src*='"+w()+"']");return n&&n.getAttribute("src")&&(t=n.getAttribute("src")),t}function m(){if(o.api.isConfigurationNeeded()){var t=w();y("Using integrationScriptBaseName: "+t);var n="MZsy5sFESYqU7MawXZgR_w",e=undefined,i=undefined;s.startsWith("@")||y("Overriding apiKey with installation param: "+(n=s)),u.startsWith("@")||y("Overriding unbluEntryPath with installation param: "+(e=u)),c.startsWith("@")||y("Overriding unbluServerUrl with installation param: "+(i=c));var r=N();if(r){var a=r.match(/x-unblu-apikey=([^&]+)/);a&&2===a.length&&a[1]&&(n=decodeURIComponent(a[1]),y("Overriding apiKey with script param: "+n)),(a=r.match(/x-unblu-entrypath=([^&]+)/))&&2===a.length&&a[1]&&(e=decodeURIComponent(a[1]),y("Overriding unbluEntryPath with script param: "+e)),(a=r.match(/x-unblu-serverurl=([^&]+)/))&&2===a.length&&a[1]&&(i=decodeURIComponent(a[1]),y("Overriding unbluServerUrl with script param: "+i))}y("Configuring Unblu API with apiKey: "+n+", entryPath: "+e+", serverUrl: "+i);var l={apiKey:n};e&&(l.entryPath=e),i&&(l.serverUrl=i),o.api.configure(l)}}n.unbluIntegrationComponent={isSessionActive:I,openIndividualUi:function(){return i(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return y("openIndividualUi called"),m(),[4,o.api.initialize()];case 1:return[4,t.sent().ui.openIndividualUi()];case 2:return t.sent(),[2]}}))}))},isAgentAvailable:function(){return i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return y("isAgentAvailable called"),m(),[4,o.api.initialize()];case 1:return[4,n.sent().isAgentAvailable()];case 2:return t=n.sent(),y("isAgentAvailable result: "+t),[2,t]}}))}))},startChat:function(){return i(this,void 0,void 0,(function(){var t,n,e;return r(this,(function(i){switch(i.label){case 0:if(y("startChat called"),d)return y("startChat: aborted as another conversation is already starting"),[2,Promise.reject("Another conversation is already starting")];d=!0,t=null,i.label=1;case 1:return i.trys.push([1,,8,9]),m(),[4,o.api.initialize()];case 2:return[4,(n=i.sent()).getActiveConversation()];case 3:return null!==(e=i.sent())?[3,5]:(window.name="",[4,n.startConversation(a.ConversationType.CHAT_REQUEST)]);case 4:return e=i.sent(),y("startChat result: "+e.getConversationId()),[3,6];case 5:y("startChat result: no action (session already active)"),i.label=6;case 6:return[4,n.ui.openIndividualUi()];case 7:return i.sent(),t=e.getConversationId(),[3,9];case 8:return d=!1,[7];case 9:return[2,t]}}))}))},startWithPin:function(t){return i(this,void 0,void 0,(function(){var n,e,i;return r(this,(function(r){switch(r.label){case 0:if(y("startWithPin"),d)return y("startWithPin: aborted as another conversation is already starting"),[2,Promise.reject("Another conversation is already starting")];d=!0,n=null,r.label=1;case 1:return r.trys.push([1,,7,8]),m(),[4,o.api.initialize()];case 2:return[4,(e=r.sent()).getActiveConversation()];case 3:return null!==(i=r.sent())?[3,5]:(window.name="",[4,e.joinConversation(t)]);case 4:return i=r.sent(),y("startWithPin result: "+i.getConversationId()),[3,6];case 5:y("startWithPin result: No action (session already active)"),r.label=6;case 6:return n=i.getConversationId(),[3,8];case 7:return d=!1,[7];case 8:return[2,n]}}))}))},checkVideo:function(t,n){return i(this,void 0,void 0,(function(){var e,i;return r(this,(function(r){switch(r.label){case 0:return y("checkVideo called"),window.unbluVideoExt?[3,2]:(e=void 0,f.startsWith("@")?(i=N())?(i.indexOf("#")>-1&&(i=i.substring(0,i.indexOf("#"))),i.indexOf("?")>-1&&(i=i.substring(0,i.indexOf("?"))),i=i.indexOf("/")>-1?i.substring(0,i.lastIndexOf("/")+1):"",e=i+h):e=h:e=f,[4,A(e)]);case 1:r.sent(),r.label=2;case 2:return[2,window.unbluVideoExt.checkVideoFunctionality(t,n)]}}))}))},startVideo:function(t){return i(this,void 0,void 0,(function(){var t,n,e;return r(this,(function(i){switch(i.label){case 0:if(y("startVideo called"),d)return y("startVideo: aborted as another conversation is already starting"),[2,Promise.reject("Another conversation is already starting")];d=!0,t=null,i.label=1;case 1:return i.trys.push([1,,8,9]),m(),[4,o.api.initialize()];case 2:return[4,(n=i.sent()).getActiveConversation()];case 3:return null!==(e=i.sent())?[3,5]:(window.name="",[4,n.startConversation(a.ConversationType.VIDEO_REQUEST)]);case 4:return e=i.sent(),y("startVideo result: "+e.getConversationId()),[3,6];case 5:y("startVideo result: no action (session already active)"),i.label=6;case 6:return[4,n.ui.openIndividualUi()];case 7:return i.sent(),t=e.getConversationId(),[3,9];case 8:return d=!1,[7];case 9:return[2,t]}}))}))},setNewConversationInterceptor:function(t){return i(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return y("setNewConversationInterceptor called"),o.api.isInitialized()?(m(),[4,o.api.initialize()]):(y("api not initialized yet - buffering interceptor for later setup"),v.push(t),[2]);case 1:return[2,n.sent().setNewConversationInterceptor(t)]}}))}))}},function(){i(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,g()];case 1:return n.sent(),[4,b()];case 2:return n.sent(),[4,E()];case 3:return n.sent(),function(){y("fireUnbluIntegrationComponentReadyEvent called");var t=new Event("unbluIntegrationComponentReady");window.dispatchEvent(t)}(),[3,5];case 4:return t=n.sent(),console.error("Error during init of Unblu Integration Component",t),[3,5];case 5:return[2]}}))}))}()},274:function(t,n,e){e.r(n),e.d(n,{Conversation:function(){return f},UnbluApi:function(){return A},api:function(){return Q}});var i,r,o=(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});!function(t){t.UNSUPPORTED_BROWSER="UNSUPPORTED_BROWSER",t.INITIALIZATION_TIMEOUT="INITIALIZATION_TIMEOUT",t.CONFIGURATION_MISSING="CONFIGURATION_MISSING",t.ERROR_LOADING_UNBLU="ERROR_LOADING_UNBLU",t.INCOMPATIBLE_UNBLU_VERSION="INCOMPATIBLE_UNBLU_VERSION",t.INVALID_FUNCTION_CALL="INVALID_FUNCTION_CALL",t.INVALID_FUNCTION_ARGUMENTS="INVALID_FUNCTION_ARGUMENTS",t.ACTION_NOT_GRANTED="ACTION_NOT_GRANTED",t.EXECUTION_EXCEPTION="EXECUTION_EXCEPTION",t.ILLEGAL_STATE="ILLEGAL_STATE"}(r||(r={}));var a,s,u=function(t){function n(n,e){var i=t.call(this,"type: "+n+", detail: "+e)||this;return i.type=n,i.detail=e,i.name="UnbluApiError",i}return o(n,t),n}(Error),c=function(){function t(){this.listeners={}}return t.prototype.reset=function(){this.listeners={}},t.prototype.on=function(t,n){this.listeners[t]=this.listeners[t]||[],-1===this.listeners[t].indexOf(n)&&this.listeners[t].push(n)},t.prototype.off=function(t,n){var e=this.listeners[t]||[],i=e.indexOf(n);return i>-1&&(e.splice(i,1),!0)},t.prototype.offAll=function(t){delete this.listeners[t]},t.prototype.hasListeners=function(t){return null!=this.listeners[t]&&this.listeners[t].length>0},t.prototype.getEventsWithListeners=function(){var t=[];for(var n in this.listeners)this.listeners[n].length&&t.push(n);return t},t.prototype.emit=function(t,n){var e=this.listeners[t];e&&e.forEach((function(e){try{e(n)}catch(n){console.warn("Error dispatching event:",t,"in listener:",e,n)}}))},t}(),l=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},p=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},f=function(){function t(n,e){var i=this;this.internalApi=n,this.conversationId=e,this.eventEmitter=new c,this.internalListeners={},this.destroyed=!1,this.on(t.CLOSE,(function(){return i.destroy()}))}return t.prototype.on=function(t,n){this.checkNotDestroyed();var e=!this.eventEmitter.hasListeners(t);this.eventEmitter.on(t,n),e&&this.onInternal(t)},t.prototype.off=function(t,n){this.checkNotDestroyed();var e=this.eventEmitter.off(t,n);return this.eventEmitter.hasListeners(t)||this.offInternal(t),e},t.prototype.onInternal=function(n){var e,i=this;switch(n){case t.CONNECTION_STATE_CHANGE:e=function(t){t.data.conversationId==i.conversationId&&i.eventEmitter.emit(t.name,t.data.connectionState)};break;case t.CONVERSATION_STATE_CHANGE:e=function(t){t.data.conversationId==i.conversationId&&i.eventEmitter.emit(t.name,t.data.conversationState)};break;case t.CALL_STATE_CHANGE:e=function(t){t.data.conversationId==i.conversationId&&i.eventEmitter.emit(t.name,t.data.callState)};break;case t.INVITATIONS_CHANGE:e=function(t){t.data.conversationId==i.conversationId&&i.eventEmitter.emit(t.name,t.data.invitations)};break;default:e=function(t){t.data==i.conversationId&&i.eventEmitter.emit(t.name)}}this.internalListeners[n]=e,this.internalApi.conversation.on(n,e).catch((function(t){return console.warn("Error registering internal listener for event:",n,"error:"+t,t)}))},t.prototype.offInternal=function(t){var n=this.internalListeners[t];null!=n&&(delete this.internalListeners[t],this.internalApi.conversation.off(t,n).catch((function(n){return console.warn("Error removing internal listener for event:",t,"error:"+n,n)})))},t.prototype.getConversationId=function(){return this.conversationId},t.prototype.getConnectionState=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.getConnectionState(this.conversationId)]}))}))},t.prototype.getConversationState=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.getConversationState(this.conversationId)]}))}))},t.prototype.getCallState=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.getCallState(this.conversationId)]}))}))},t.prototype.createAnonymousPinInvitation=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.createAnonymousPinInvitation(this.conversationId)]}))}))},t.prototype.createAnonymousEmailInvitation=function(t){return l(this,void 0,void 0,(function(){return p(this,(function(n){return this.checkNotDestroyed(),[2,this.internalApi.conversation.createAnonymousEmailInvitation(this.conversationId,t)]}))}))},t.prototype.revokeInvitation=function(t){return l(this,void 0,void 0,(function(){return p(this,(function(n){return this.checkNotDestroyed(),[2,this.internalApi.conversation.revokeInvitation(this.conversationId,t)]}))}))},t.prototype.renewInvitationPin=function(t){return l(this,void 0,void 0,(function(){return p(this,(function(n){return this.checkNotDestroyed(),[2,this.internalApi.conversation.renewInvitationPin(this.conversationId,t)]}))}))},t.prototype.getInvitations=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.getInvitations(this.conversationId)]}))}))},t.prototype.startAudioCall=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.startAudioCall(this.conversationId)]}))}))},t.prototype.startVideoCall=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.startVideoCall(this.conversationId)]}))}))},t.prototype.endConversation=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.endConversation(this.conversationId)]}))}))},t.prototype.leaveConversation=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.leaveConversation(this.conversationId)]}))}))},t.prototype.closeConversation=function(){return l(this,void 0,void 0,(function(){return p(this,(function(t){return this.checkNotDestroyed(),[2,this.internalApi.conversation.closeConversation(this.conversationId)]}))}))},t.prototype.checkNotDestroyed=function(){if(this.destroyed)throw new u(r.ILLEGAL_STATE,"Error: trying to execute method on destroyed conversation object.")},t.prototype.isDestroyed=function(){return this.destroyed},t.prototype.destroy=function(){if(!this.destroyed)for(var t in this.destroyed=!0,this.eventEmitter.reset(),this.internalListeners)this.offInternal(t)},t.CONNECTION_STATE_CHANGE="connectionStateChange",t.CONVERSATION_STATE_CHANGE="conversationStateChange",t.CALL_STATE_CHANGE="callStateChange",t.END="end",t.CLOSE="close",t.INVITATIONS_CHANGE="invitationsChange",t}(),h=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},d=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},v=function(){function t(t){var n=this;this.internalApi=t,this.internalListeners={},this.eventEmitter=new c,t.meta.on("upgraded",(function(){return n.onUpgraded()}))}return t.prototype.on=function(t,n){var e=!this.eventEmitter.hasListeners(t);this.eventEmitter.on(t,n),e&&this.onInternal(t).catch((function(n){return console.warn("Error registering internal listener for event:",t,"error:"+n,n)}))},t.prototype.off=function(t,n){var e=this.eventEmitter.off(t,n);return this.eventEmitter.hasListeners(t)||this.offInternal(t).catch((function(n){return console.warn("Error removing internal listener for event:",t,"error:"+n,n)})),e},t.prototype.onInternal=function(n){return h(this,void 0,void 0,(function(){var e,i,o=this;return d(this,(function(a){switch(a.label){case 0:switch(n){case t.UI_STATE_CHANGE:e=function(t){o.eventEmitter.emit(t.name,t.data)};break;default:throw new u(r.INVALID_FUNCTION_ARGUMENTS,"Registration to unknown event:"+n)}return[4,this.internalApi.meta.isUpgraded()];case 1:if(!a.sent())return[3,5];this.internalListeners[n]=e,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.internalApi.general.on(n,e)];case 3:return a.sent(),[3,5];case 4:throw i=a.sent(),delete this.internalListeners[n],i;case 5:return[2]}}))}))},t.prototype.offInternal=function(t){return h(this,void 0,void 0,(function(){var n;return d(this,(function(e){switch(e.label){case 0:return null==(n=this.internalListeners[t])?[2]:(delete this.internalListeners[t],[4,this.internalApi.general.off(t,n)]);case 1:return e.sent(),[2]}}))}))},t.prototype.toggleIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.toggleIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.openPinEntryUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.openPinEntryUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.popoutIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.popoutIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.popinIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.popinIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.maximizeIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.maximizeIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.minimizeIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.minimizeIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.openIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.openIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.collapseIndividualUi=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.collapseIndividualUi()];case 2:return t.sent(),[2]}}))}))},t.prototype.getIndividualUiState=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[4,this.internalApi.general.getIndividualUiState()];case 2:return[2,t.sent()]}}))}))},t.prototype.requireUpgrade=function(){return h(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.internalApi.meta.upgrade(!1)];case 1:return t.sent(),[2]}}))}))},t.prototype.onUpgraded=function(){for(var t=0,n=this.eventEmitter.getEventsWithListeners();t<n.length;t++){var e=n[t];this.internalListeners[e]||this.onInternal(e)}},t.UI_STATE_CHANGE="uiStateChange",t}(),y=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},I=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},A=function(){function t(t){var n=this;this.internalApi=t,this.internalListeners={},this.eventEmitter=new c,t.meta.on("upgraded",(function(){return n.onUpgraded()})),this.ui=new v(t)}return t.prototype.on=function(t,n){var e=!this.eventEmitter.hasListeners(t);this.eventEmitter.on(t,n),e&&this.onInternal(t).catch((function(n){return console.warn("Error registering internal listener for event:",t,"error:"+n,n)}))},t.prototype.off=function(t,n){var e=this.eventEmitter.off(t,n);return this.eventEmitter.hasListeners(t)||this.offInternal(t).catch((function(n){return console.warn("Error removing internal listener for event:",t,"error:"+n,n)})),e},t.prototype.onInternal=function(n){return y(this,void 0,void 0,(function(){var e,i,o,a,s,c=this;return I(this,(function(l){switch(l.label){case 0:switch(n){case t.AGENT_AVAILABILITY_CHANGE:e=function(t){c.eventEmitter.emit(t.name,t.data)},i=this.internalApi.agentAvailability,o=!1;break;case t.ACTIVE_CONVERSATION_CHANGE:e=function(t){c.eventEmitter.emit(t.name,t.data?new f(c.internalApi,t.data):null)},i=this.internalApi.general,o=!0;break;case t.NOTIFICATION_COUNT_CHANGE:case t.PERSON_CHANGE:e=function(t){c.eventEmitter.emit(t.name,t.data)},i=this.internalApi.general,o=!0;break;default:throw new u(r.INVALID_FUNCTION_ARGUMENTS,"Registration to unknown event:"+n)}return(a=!o)?[3,2]:[4,this.internalApi.meta.isUpgraded()];case 1:a=l.sent(),l.label=2;case 2:if(!a)return[3,6];this.internalListeners[n]=e,l.label=3;case 3:return l.trys.push([3,5,,6]),[4,i.on(n,e)];case 4:return l.sent(),[3,6];case 5:throw s=l.sent(),delete this.internalListeners[n],s;case 6:return[2]}}))}))},t.prototype.offInternal=function(n){return y(this,void 0,void 0,(function(){var e,i;return I(this,(function(r){switch(r.label){case 0:if(null==(e=this.internalListeners[n]))return[2];switch(delete this.internalListeners[n],n){case t.AGENT_AVAILABILITY_CHANGE:i=this.internalApi.agentAvailability;break;default:i=this.internalApi.general}return[4,i.off(n,e)];case 1:return r.sent(),[2]}}))}))},t.prototype.getPersonInfo=function(){return y(this,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,this.requireUpgrade()];case 1:return t.sent(),[2,this.internalApi.general.getPersonInfo()]}}))}))},t.prototype.setPersonNickname=function(t){return y(this,void 0,void 0,(function(){return I(this,(function(n){switch(n.label){case 0:return[4,this.requireUpgrade()];case 1:return n.sent(),[2,this.internalApi.general.setPersonNickname(t)]}}))}))},t.prototype.getNotificationCount=function(){return y(this,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,this.internalApi.meta.isUpgraded()];case 1:return t.sent()?[2,this.internalApi.general.getNotificationCount()]:[2,this.internalApi.generalLazy.getNotificationCount()]}}))}))},t.prototype.startConversation=function(t,n,e){return y(this,void 0,void 0,(function(){var i;return I(this,(function(r){switch(r.label){case 0:return[4,this.requireUpgrade()];case 1:return r.sent(),[4,this.internalApi.general.startConversation(t,n,e)];case 2:return i=r.sent(),[2,new f(this.internalApi,i)]}}))}))},t.prototype.setNewConversationInterceptor=function(t){return y(this,void 0,void 0,(function(){return I(this,(function(n){switch(n.label){case 0:return[4,this.internalApi.meta.isUpgraded()];case 1:return n.sent()?[3,3]:[4,this.internalApi.generalLazy.setNewConversationInterceptor(t)];case 2:return[2,n.sent()];case 3:return[4,this.internalApi.general.setNewConversationInterceptor(t)];case 4:return[2,n.sent()]}}))}))},t.prototype.joinConversation=function(t,n){return y(this,void 0,void 0,(function(){var e;return I(this,(function(i){switch(i.label){case 0:return[4,this.requireUpgrade()];case 1:return i.sent(),[4,this.internalApi.general.joinConversation(t,n)];case 2:return e=i.sent(),[2,new f(this.internalApi,e)]}}))}))},t.prototype.openConversation=function(t){return y(this,void 0,void 0,(function(){return I(this,(function(n){switch(n.label){case 0:return[4,this.requireUpgrade()];case 1:return n.sent(),[4,this.internalApi.general.openConversation(t)];case 2:return n.sent(),[2,new f(this.internalApi,t)]}}))}))},t.prototype.getActiveConversation=function(){return y(this,void 0,void 0,(function(){var t;return I(this,(function(n){switch(n.label){case 0:return[4,this.internalApi.meta.isUpgraded()];case 1:return n.sent()?[4,this.internalApi.general.getActiveConversation()]:[3,3];case 2:return[2,null!=(t=n.sent())?new f(this.internalApi,t):null];case 3:return[2,null]}}))}))},t.prototype.isAgentAvailable=function(){return y(this,void 0,void 0,(function(){return I(this,(function(t){return[2,this.internalApi.agentAvailability.isAgentAvailable()]}))}))},t.prototype.getAgentAvailabilityState=function(){return y(this,void 0,void 0,(function(){return I(this,(function(t){return[2,this.internalApi.agentAvailability.getAgentAvailabilityState()]}))}))},t.prototype.requireUpgrade=function(){return y(this,void 0,void 0,(function(){return I(this,(function(t){switch(t.label){case 0:return[4,this.internalApi.meta.upgrade(!1)];case 1:return t.sent(),[2]}}))}))},t.prototype.onUpgraded=function(){for(var t=0,n=this.eventEmitter.getEventsWithListeners();t<n.length;t++){var e=n[t];this.internalListeners[e]||this.onInternal(e)}},t.ACTIVE_CONVERSATION_CHANGE="activeConversationChange",t.NOTIFICATION_COUNT_CHANGE="notificationCountChange",t.PERSON_CHANGE="personChange",t.AGENT_AVAILABILITY_CHANGE="availabilityChange",t}(),b=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},E=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},g=function(){function t(){}return t.loadScript=function(t,n){return b(this,void 0,void 0,(function(){var e,i;return E(this,(function(r){return e=n||3e4,(i=document.createElement("script")).setAttribute("charset","UTF-8"),i.setAttribute("type","text/javascript"),i.setAttribute("async","true"),i.setAttribute("timeout",e.toString()),i.src=t,[2,new Promise((function(n,r){var o,a=function(){i.onerror=i.onload=null,window.clearTimeout(o)},s=function(n){a(),console.error("Failed to load script! Uri:",t,"Error:",n),r(n)};i.onload=function(){a(),n()},i.onerror=s,o=window.setTimeout((function(){return s("Timeout")}),e),document.getElementsByTagName("HEAD")[0].appendChild(i)}))]}))}))},t.setNamedArea=function(t){var n=window.document.querySelector('meta[name="unblu:named-area"]')||window.document.createElement("meta");n.setAttribute("name","unblu:named-area"),n.setAttribute("content",t),n.parentElement||window.document.head.appendChild(n)},t.setLocale=function(n){t.getUnbluObject().l=n},t.isUnbluLoaded=function(){return t.getUnbluObject()&&!!t.getUnbluObject().APIKEY},t.getUnbluObject=function(){return window.unblu},t.createUnbluObject=function(){return window.unblu={}},t}(),w=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},N=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},m=function(){function t(t){this.mountPoint=t}return t.prototype.waitUntilLoaded=function(t,n){return w(this,void 0,void 0,(function(){var n,e=this;return N(this,(function(i){return n=Date.now()+t,[2,new Promise((function(t,i){var o=function(){if(n-Date.now()>0){if(e.checkLoaded())return t();setTimeout(o,50)}else i(new u(r.INITIALIZATION_TIMEOUT,"Timeout while waiting for collaboration server API to be loaded."))};o()}))]}))}))},t.prototype.checkLoaded=function(){return this.internal=this.mountPoint.internal,null!=this.internal},t.prototype.checkCompatibility=function(){if(!this.internal)throw new u(r.INCOMPATIBLE_UNBLU_VERSION,"Incompatible unblu collaboration server, no API bridge provided.");if("function"!=typeof this.internal.getApiVersion)throw new u(r.INCOMPATIBLE_UNBLU_VERSION,"Incompatible unblu collaboration server, incompatible API bridge.");var t=this.internal.getApiVersion();if(2!=+t[0])throw new u(r.INCOMPATIBLE_UNBLU_VERSION,"Incompatible collaboration server version. \n                Supported API version: 2.x.x.\n                collaboration server API version: "+t+".")},t.prototype.callApiFunction=function(t,n,e){return w(this,void 0,void 0,(function(){var i;return N(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.internal.execute(t,n,e)];case 1:return[2,o.sent()];case 2:switch((i=o.sent()).type){case 1:throw new u(r.INVALID_FUNCTION_CALL,i.message);case 2:throw new u(r.INVALID_FUNCTION_ARGUMENTS,i.message);case 4:throw new u(r.ACTION_NOT_GRANTED,i.message);case 3:throw new u(r.EXECUTION_EXCEPTION,i.message);default:throw new u(r.EXECUTION_EXCEPTION,""+i)}return[3,3];case 3:return[2]}}))}))},t.prototype.on=function(t,n,e){return this.internal.registerEventListener(t,n,e)},t.prototype.off=function(t,n,e){return this.internal.removeEventListener(t,n,e)},t}(),C=function(){function t(t,n){this.bridge=t,this.moduleName=n}return t.prototype.callApiFunction=function(t,n){return this.bridge.callApiFunction(this.moduleName,t,n)},t.prototype.on=function(t,n){return this.bridge.on(this.moduleName,t,n)},t.prototype.off=function(t,n){return this.bridge.off(this.moduleName,t,n)},t}(),O=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),U=function(t){function n(n){return t.call(this,n,"meta")||this}return O(n,t),n.prototype.isUpgraded=function(){return this.callApiFunction("isUpgraded",[])},n.prototype.upgrade=function(t){return this.callApiFunction("upgrade",[t])},n.prototype.waitUntilInitialized=function(){return this.callApiFunction("waitUntilInitialized",[])},n}(C),_=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),T=function(t){function n(n){return t.call(this,n,"general")||this}return _(n,t),n.prototype.startConversation=function(t,n,e){return this.callApiFunction("startConversation",[t,n,e])},n.prototype.setNewConversationInterceptor=function(t){return this.callApiFunction("setNewConversationInterceptor",[t])},n.prototype.joinConversation=function(t,n){return this.callApiFunction("joinConversation",[t,n])},n.prototype.openConversation=function(t){return this.callApiFunction("openConversation",[t])},n.prototype.toggleIndividualUi=function(){return this.callApiFunction("toggleIndividualUi",[])},n.prototype.openPinEntryUi=function(){return this.callApiFunction("openPinEntryUi",[])},n.prototype.popoutIndividualUi=function(){return this.callApiFunction("popoutIndividualUi",[])},n.prototype.popinIndividualUi=function(){return this.callApiFunction("popinIndividualUi",[])},n.prototype.maximizeIndividualUi=function(){return this.callApiFunction("maximizeIndividualUi",[])},n.prototype.minimizeIndividualUi=function(){return this.callApiFunction("minimizeIndividualUi",[])},n.prototype.openIndividualUi=function(){return this.callApiFunction("openIndividualUi",[])},n.prototype.collapseIndividualUi=function(){return this.callApiFunction("collapseIndividualUi",[])},n.prototype.getIndividualUiState=function(){return this.callApiFunction("getIndividualUiState",[])},n.prototype.getActiveConversation=function(){return this.callApiFunction("getActiveConversation",[])},n.prototype.getNotificationCount=function(){return this.callApiFunction("getNotificationCount",[])},n.prototype.getPersonInfo=function(){return this.callApiFunction("getPersonInfo",[])},n.prototype.setPersonNickname=function(t){return this.callApiFunction("setPersonNickname",[t])},n}(C),S=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),L=function(t){function n(n){return t.call(this,n,"generallazy")||this}return S(n,t),n.prototype.getNotificationCount=function(){return this.callApiFunction("getNotificationCount",[])},n.prototype.getPersonInfo=function(){return this.callApiFunction("getPersonInfo",[])},n.prototype.setNewConversationInterceptor=function(t){return this.callApiFunction("setNewConversationInterceptor",[t])},n}(C),R=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),P=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},D=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},k=function(t){function n(n){return t.call(this,n,"conversation")||this}return R(n,t),n.prototype.getConnectionState=function(t){return this.callApiFunction("getConnectionState",[t])},n.prototype.getConversationState=function(t){return this.callApiFunction("getConversationState",[t])},n.prototype.getCallState=function(t){return this.callApiFunction("getCallState",[t])},n.prototype.startAudioCall=function(t){return this.callApiFunction("startAudioCall",[t])},n.prototype.startVideoCall=function(t){return this.callApiFunction("startVideoCall",[t])},n.prototype.endConversation=function(t){return this.callApiFunction("endConversation",[t])},n.prototype.leaveConversation=function(t){return this.callApiFunction("leaveConversation",[t])},n.prototype.closeConversation=function(t){return this.callApiFunction("closeConversation",[t])},n.prototype.createAnonymousPinInvitation=function(t){return this.callApiFunction("createAnonymousPinInvitation",[t])},n.prototype.createAnonymousEmailInvitation=function(t,n){return this.callApiFunction("createAnonymousEmailInvitation",[t,n])},n.prototype.getInvitations=function(t){return P(this,void 0,void 0,(function(){return D(this,(function(n){return[2,this.callApiFunction("getInvitations",[t])]}))}))},n.prototype.revokeInvitation=function(t,n){return P(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.callApiFunction("revokeInvitation",[t,n])]}))}))},n.prototype.renewInvitationPin=function(t,n){return P(this,void 0,void 0,(function(){return D(this,(function(e){return[2,this.callApiFunction("renewInvitationPin",[t,n])]}))}))},n}(C),x=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),G=function(t){function n(n){return t.call(this,n,"agentavailability")||this}return x(n,t),n.prototype.isAgentAvailable=function(){return this.callApiFunction("isAgentAvailable",[])},n.prototype.getAgentAvailabilityState=function(){return this.callApiFunction("getAgentAvailabilityState",[])},n}(C),F=function(){function t(t){this.bridge=t,this.meta=new U(t),this.general=new T(t),this.generalLazy=new L(t),this.conversation=new k(t),this.agentAvailability=new G(t)}return t.prototype.checkCompatibility=function(){this.bridge.checkCompatibility()},t}(),V=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):new e((function(n){n(t.value)})).then(a,s)}u((i=i.apply(t,n||[])).next())}))},B=function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},j=function(){function t(){var n=this;this.state="INITIAL",this.eventEmitter=new c,this.eventEmitter.on(t.ERROR,(function(t){return n.error=t}));var e=g.getUnbluObject();e.api?this.handleError(new u(r.ILLEGAL_STATE,"Unblu API has already been loaded.")):e.api=this,g.isUnbluLoaded()&&this.initializeApi().catch((function(t){return console.warn("Error during auto initialization",t)}))}return t.prototype.on=function(n,e){n==t.READY&&"INITIALIZED"==this.state?e(this.initializedApi):n==t.ERROR&&"ERROR"==this.state?e(this.error):this.eventEmitter.on(n,e)},t.prototype.off=function(t,n){return this.eventEmitter.off(t,n)},t.prototype.isConfigurationNeeded=function(){return"INITIAL"===this.state&&!g.isUnbluLoaded()},t.prototype.getApiState=function(){return this.state},t.prototype.isInitialized=function(){return"INITIALIZED"===this.state},t.prototype.configure=function(t){if(g.isUnbluLoaded())throw new u(r.ILLEGAL_STATE,"Configure called when Unblu was already loaded.");if("INITIAL"!==this.state)throw new u(r.ILLEGAL_STATE,"Error configure called after API was already initialized.");return this.configuration=t,this},t.prototype.initialize=function(){return V(this,void 0,void 0,(function(){var n=this;return B(this,(function(e){return"INITIALIZED"===this.state?[2,this.initializedApi]:"INITIALIZING"===this.state?[2,new Promise((function(e,i){n.on(t.READY,e),n.on(t.ERROR,i)}))]:[2,this.initializeApi()]}))}))},t.prototype.initializeApi=function(){return V(this,void 0,void 0,(function(){var n,e,i;return B(this,(function(o){switch(o.label){case 0:this.state="INITIALIZING",o.label=1;case 1:if(o.trys.push([1,6,,7]),g.isUnbluLoaded())return[3,3];if(!this.configuration)throw new u(r.CONFIGURATION_MISSING,"No Unblu snippet present and no configuration provided. Use configure if you want to initialize Unblu without having the Unblu snippet loaded.");return this.configuration.namedArea&&g.setNamedArea(this.configuration.namedArea),this.configuration.locale&&g.setLocale(this.configuration.locale),[4,this.injectUnblu(this.configuration)];case 2:o.sent(),o.label=3;case 3:return[4,(n=new m(g.getUnbluObject())).waitUntilLoaded(this.configuration&&this.configuration.initTimeout||3e4)];case 4:return o.sent(),(e=new F(n)).checkCompatibility(),[4,e.meta.waitUntilInitialized()];case 5:return o.sent(),this.initializedApi=new A(e),this.state="INITIALIZED",[3,7];case 6:return i=o.sent(),this.handleError(i),[3,7];case 7:return this.eventEmitter.emit(t.READY,this.initializedApi),[2,this.initializedApi]}}))}))},t.prototype.injectUnblu=function(t){return V(this,void 0,void 0,(function(){var n,e,i,o,a;return B(this,(function(s){switch(s.label){case 0:n=t.serverUrl||"",e=t.apiKey||"",i=t.entryPath||"/unblu",o=""+n+i+"/visitor.js?x-unblu-apikey="+e,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,g.loadScript(o,t.initTimeout)];case 2:return s.sent(),[3,4];case 3:throw a=s.sent(),new u(r.ERROR_LOADING_UNBLU,"Error loading unblu snippet: "+a+" check the configuration: "+t);case 4:return[2]}}))}))},t.prototype.handleError=function(n){throw this.state="ERROR",this.eventEmitter.emit(t.ERROR,n),console.error(n),n},t.READY="ready",t.ERROR="error",t}();!function(t){t.INBOUND="INBOUND",t.OUTBOUND="OUTBOUND",t.ACTIVE_JOINED="ACTIVE_JOINED",t.ACTIVE_NOT_JOINED="ACTIVE_NOT_JOINED",t.ACTIVE_JOINED_ELSEWHERE="ACTIVE_JOINED_ELSEWHERE",t.NONE="NONE"}(a||(a={})),function(t){t.INITIAL="INITIAL",t.CONNECTING="CONNECTING",t.CONNECTED="CONNECTED",t.RECONNECTING="RECONNECTING",t.CLOSED="CLOSED",t.ERROR="ERROR"}(s||(s={}));var z,H,M=e(350);!function(t){t.AVAILABLE="AVAILABLE",t.BUSY="BUSY",t.UNAVAILABLE="UNAVAILABLE",t.OFFLINE="OFFLINE"}(z||(z={})),function(t){t.CREATED="CREATED",t.ONBOARDING="ONBOARDING",t.REBOARDING="REBOARDING",t.QUEUED="QUEUED",t.ACTIVE="ACTIVE",t.UNASSIGNED="UNASSIGNED",t.OFFBOARDING="OFFBOARDING",t.ENDED="ENDED"}(H||(H={}));var W=g.getUnbluObject()||g.createUnbluObject();W.AgentAvailabilityState=z,W.CallState=a,W.ConnectionState=s,W.ConversationState=H,W.ConversationType=M.ConversationType,W.UnbluErrorType=r;var Q=new j},350:function(t,n,e){var i;e.r(n),e.d(n,{ConversationType:function(){return i}}),function(t){t.CHAT_REQUEST="CHAT_REQUEST",t.OFFLINE_CHAT_REQUEST="OFFLINE_CHAT_REQUEST",t.VIDEO_REQUEST="VIDEO_REQUEST",t.AUDIO_REQUEST="AUDIO_REQUEST",t.HEADLESS_BROWSER_REQUEST="HEADLESS_BROWSER_REQUEST",t.DOMCAP_BROWSER_REQUEST="DOMCAP_BROWSER_REQUEST",t.MOBILE_COBROWSING_REQUEST="MOBILE_COBROWSING_REQUEST",t.SCREEN_SHARING_REQUEST="SCREEN_SHARING_REQUEST",t.VISITOR_COBROWSING="VISITOR_COBROWSING"}(i||(i={}))}},n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{}};return t[i].call(r.exports,r,r.exports,e),r.exports}return e.d=function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e(408)}());
//# sourceMappingURL=unblu.integration.component.min.js.map